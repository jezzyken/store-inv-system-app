"use strict";(self["webpackChunkvue2"]=self["webpackChunkvue2"]||[]).push([[877],{541:function(t,e,s){s.r(e),s.d(e,{default:function(){return C}});var i=s(7678),a=s(3740),n=s(4414),l=s(3449),o=s(1446),r=s(9483),c=s(6930),d=s(7683),u=s(2756),h=s(4312),m=s(8184),p=s(2498),I=s(1034),f=s(7112),v=function(){var t=this,e=t._self._c;return t.isLoading?t._e():e(l.A,[e(m.A,{staticClass:"pa-5",attrs:{elevation:"1"}},[e("p",{staticClass:"text-button"},[t._v("Product Information")]),e(r.A,{staticClass:"mb-5"}),e(u.A,[e(n.A,{attrs:{cols:"12",md:"6"}},[e(d.A,{ref:"menu",attrs:{"close-on-content-click":!1,"return-value":t.items.date,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(e){return t.$set(t.items,"date",e)},"update:return-value":function(e){return t.$set(t.items,"date",e)}},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:i}){return[e(f.A,t._g(t._b({attrs:{label:"Date","prepend-inner-icon":"mdi-calendar",readonly:"",outlined:""},model:{value:t.items.date,callback:function(e){t.$set(t.items,"date",e)},expression:"items.date"}},"v-text-field",i,!1),s))]}}],null,!1,2585148267),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[e(o.A,{attrs:{"no-title":"",scrollable:""},model:{value:t.items.date,callback:function(e){t.$set(t.items,"date",e)},expression:"items.date"}},[e(I.A),e(a.A,{attrs:{text:"",color:"#000033"},on:{click:function(e){t.menu=!1}}},[t._v(" Cancel ")]),e(a.A,{attrs:{text:"",color:"#000033"},on:{click:function(e){return t.$refs.menu.save(t.items.date)}}},[t._v(" OK ")])],1)],1)],1),e(n.A,{attrs:{cols:"6"}},[e("div",{staticClass:"d-flex"},[e(i.A,{attrs:{label:"Products",items:t.products,"item-text":"name","item-value":"productCode",outlined:"","return-object":""},on:{change:t.onSelectItem},model:{value:t.items.product,callback:function(e){t.$set(t.items,"product",e)},expression:"items.product"}})],1)])],1)],1),e(m.A,{staticClass:"pa-5 mt-5",attrs:{elevation:"1"}},[e("p",{staticClass:"text-button"},[t._v("Stocks")]),e(r.A,{staticClass:"mb-5"}),e(p.A,{scopedSlots:t._u([{key:"default",fn:function(){return[e("thead",[e("tr",[e("th",{staticClass:"text-left"},[t._v("Product")]),e("th",{staticClass:"text-left"},[t._v("Stocks")]),e("th",{staticClass:"text-center"},[t._v("Quantity")]),"add"===t.mode?e("th",{staticClass:"text-left"},[t._v("Actions")]):t._e()])]),e("tbody",t._l(t.items.stocks,(function(s,i){return e("tr",{key:i},[e("td",{staticClass:"pa-5"},[e("span",[t._v(t._s(s.name))])]),e("td",{staticClass:"pa-5"},[e("span",[t._v(t._s(s.availableStocks))])]),e("td",[e("div",{staticClass:"d-flex justify-center"},["add"===t.mode?e(a.A,{attrs:{dark:"",color:"#000033",small:"",fab:""}},[e(c.A,[t._v("mdi-plus")])],1):t._e(),e("div",{staticStyle:{width:"75px"}},[e(f.A,{staticClass:"text-center mx-2",attrs:{outlined:"","hide-details":"",dense:"",type:"number",min:"0"},on:{input:function(e){return t.validateQuantity(e,s)},keypress:function(e){return t.numberOnly(e)}},model:{value:s.quantity,callback:function(e){t.$set(s,"quantity",t._n(e))},expression:"stock.quantity"}})],1),"add"===t.mode?e(a.A,{attrs:{dark:"",color:"#000033",small:"",fab:""}},[e(c.A,[t._v("mdi-minus")])],1):t._e()],1)]),"add"===t.mode?e("td",[e(a.A,{attrs:{dark:"",color:"error",small:""},on:{click:function(e){return t.onDeleteItem(s,i)}}},[e(c.A,[t._v("mdi-trash-can-outline")])],1)],1):t._e()])})),0)]},proxy:!0}],null,!1,1634048311)})],1),0!=t.items.stocks?e(m.A,{staticClass:"pa-5 mt-5",attrs:{elevation:"1"}},[e(u.A,[e(n.A,{attrs:{cols:"12",md:"4"}},[e(f.A,{attrs:{label:"Notes",outlined:""},model:{value:t.items.notes,callback:function(e){t.$set(t.items,"notes",e)},expression:"items.notes"}})],1),e(n.A,{attrs:{cols:"12",md:"2"}},[e(h.A,{attrs:{label:"Status",items:t.status,outlined:""},model:{value:t.items.status,callback:function(e){t.$set(t.items,"status",e)},expression:"items.status"}})],1)],1)],1):t._e(),e(u.A,{staticClass:"ma-0 mt-6",attrs:{justify:"end"}},["add"===t.mode?e(a.A,{attrs:{dark:"",color:t.buttonState.color},on:{click:t.buttonState.action}},[t._v(t._s(t.buttonState.label))]):t._e(),e("div",{staticClass:"ma-1"}),"add"===t.mode?e(a.A,{on:{click:t.clearForm}},[t._v("Clear")]):e(a.A,{on:{click:function(e){return t.$router.go(-1)}}},[t._v("Back")])],1)],1)},S=[],y=(s(4114),s(5353)),g=s(5093),k=s.n(g),x={props:{mode:String},data(){return{items:{stocks:[],date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10)},isLoading:!1,category:[],unit:[],prices:[],brand:[],products:[],suppliers:[],stocks:[],variants:[],colors:[],variantColorItems:[],variantId:null,productId:null,status:["Pending","Completed"],deleteItemId:[],menu:!1}},computed:{buttonState(){let t={color:"warning",action:this.onUpdateItem,label:"update"};return"add"===this.mode&&(t={color:"#000033",action:this.onAddItem,label:"add"}),t}},async created(){this.fetch(),this.$route?.params?.id&&this.initialize()},methods:{...(0,y.i0)({getProductItems:"product/getItems",addItem:"stock/addItem",getSupplierItems:"supplier/getItem",getStockById:"stock/getItemById",updateItem:"stock/updateItem",deleteItem:"stockItem/deleteItem"}),async initialize(){this.isLoading=!0;const t=await this.getStockById(this.$route.params.id),{status:e,notes:s,date:i,stockItems:a}=t.result[0];this.items.status=e,this.items.notes=s,this.items.date=k()(i).format("YYYY-MM-DD");for(let n of a){const t={name:n.product.name,quantity:n.quantity,availableStocks:n.product.stocks,product:n.product._id,_id:n.product._id,items_id:n.item_id};if("Variants"===n.product.type){const e=n.product.variants.find((t=>t._id==n.variant));t.variant=e._id,t.name=e.name,t.availableStocks=e.stocks}this.items.stocks.push(t)}this.isLoading=!1},async onSelectItem(t){const e=this.items.stocks.find((e=>e.product===t._id||e.variant===t._id));if(!e){const e={name:t.name,availableStocks:t.stocks,product:t.productId};"Variants"===t.type&&(e.variant=t._id,e.name=t.name,e.availableStocks=t.stocks),this.items.stocks.push({...e,product:t.productId})}},async onAddItem(){const t={date:this.items.date,notes:this.items.notes,status:this.items.status,stocks:this.items.stocks};await this.addItem(t),this.$router.push("/stock")},async onUpdateItem(){const t={id:this.$route?.params?.id,data:{date:this.items.date,notes:this.items.notes,status:this.items.status,stocks:this.items.stocks,deletedItems:this.deleteItemId}};await this.updateItem(t),this.$router.push("/stock")},async onDeleteItem(t=null,e){this.items.stocks.splice(e,1),t.items_id&&(this.deleteItemId.includes(t.items_id)||this.deleteItemId.push(t.items_id))},validateQuantity(t,e){let s=Number(t);s<0||isNaN(s)?e.quantity=0:e.quantity=Math.floor(s)},numberOnly(t){const e=["0","1","2","3","4","5","6","7","8","9","Backspace","Delete","Tab","Enter"],s=t.key;e.includes(s)||t.preventDefault()},clearForm(){this.items={stocks:[],date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10)},this.deleteItemId=[]},async fetch(){const t=await this.getProductItems();this.products=t.result.map((t=>"Variants"===t.type&&t.variants&&t.variants.length>0?t.variants.map((e=>({...t,productId:t._id,name:e.name,upc:e.upc,stocks:e.stocks,_id:e._id}))):{...t,productId:t._id,stocks:t.stocks})).flat()}}},A=x,b=s(1656),_=(0,b.A)(A,v,S,!1,null,"4e9ad2db",null),C=_.exports},7678:function(t,e,s){s(29);var i=s(4312),a=s(7112),n=s(8041),l=s(4152);const o={...i.v,offsetY:!0,offsetOverflow:!0,transition:!1};e.A=i.A.extend({name:"v-autocomplete",props:{autoSelectFirst:{type:Boolean,default:!1},filter:{type:Function,default:(t,e,s)=>s.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1},hideNoData:Boolean,menuProps:{type:i.A.options.props.menuProps.type,default:()=>o},noFilter:Boolean,searchInput:{type:String}},data(){return{lazySearch:this.searchInput}},computed:{classes(){return{...i.A.options.computed.classes.call(this),"v-autocomplete":!0,"v-autocomplete--is-selecting-index":this.selectedIndex>-1}},computedItems(){return this.filteredItems},selectedValues(){return this.selectedItems.map((t=>this.getValue(t)))},hasDisplayedItems(){return this.hideSelected?this.filteredItems.some((t=>!this.hasItem(t))):this.filteredItems.length>0},currentRange(){return null==this.selectedItem?0:String(this.getText(this.selectedItem)).length},filteredItems(){return!this.isSearching||this.noFilter||null==this.internalSearch?this.allItems:this.allItems.filter((t=>{const e=(0,l.TD)(t,this.itemText),s=null!=e?String(e):"";return this.filter(t,String(this.internalSearch),s)}))},internalSearch:{get(){return this.lazySearch},set(t){this.lazySearch!==t&&(this.lazySearch=t,this.$emit("update:search-input",t))}},isAnyValueAllowed(){return!1},isDirty(){return this.searchIsDirty||this.selectedItems.length>0},isSearching(){return this.multiple&&this.searchIsDirty||this.searchIsDirty&&this.internalSearch!==this.getText(this.selectedItem)},menuCanShow(){return!!this.isFocused&&(this.hasDisplayedItems||!this.hideNoData)},$_menuProps(){const t=i.A.options.computed.$_menuProps.call(this);return t.contentClass=`v-autocomplete__content ${t.contentClass||""}`.trim(),{...o,...t}},searchIsDirty(){return null!=this.internalSearch&&""!==this.internalSearch},selectedItem(){return this.multiple?null:this.selectedItems.find((t=>this.valueComparator(this.getValue(t),this.getValue(this.internalValue))))},listData(){const t=i.A.options.computed.listData.call(this);return t.props={...t.props,items:this.virtualizedItems,noFilter:this.noFilter||!this.isSearching||!this.filteredItems.length,searchInput:this.internalSearch},t}},watch:{filteredItems:"onFilteredItemsChanged",internalValue:"setSearch",isFocused(t){t?(document.addEventListener("copy",this.onCopy),this.$refs.input&&this.$refs.input.select()):(document.removeEventListener("copy",this.onCopy),this.blur(),this.updateSelf())},isMenuActive(t){!t&&this.hasSlot&&(this.lazySearch=null)},items(t,e){e&&e.length||!this.hideNoData||!this.isFocused||this.isMenuActive||!t.length||this.activateMenu()},searchInput(t){this.lazySearch=t},internalSearch:"onInternalSearchChanged",itemText:"updateSelf"},created(){this.setSearch()},destroyed(){document.removeEventListener("copy",this.onCopy)},methods:{onFilteredItemsChanged(t,e){if(t!==e){if(!this.autoSelectFirst){const s=e[this.$refs.menu.listIndex];s?this.setMenuIndex(t.findIndex((t=>t===s))):this.setMenuIndex(-1),this.$emit("update:list-index",this.$refs.menu.listIndex)}this.$nextTick((()=>{this.internalSearch&&(1===t.length||this.autoSelectFirst)&&(this.$refs.menu.getTiles(),this.autoSelectFirst&&t.length&&(this.setMenuIndex(0),this.$emit("update:list-index",this.$refs.menu.listIndex)))}))}},onInternalSearchChanged(){this.updateMenuDimensions()},updateMenuDimensions(){this.isMenuActive&&this.$refs.menu&&this.$refs.menu.updateDimensions()},changeSelectedIndex(t){this.searchIsDirty||(this.multiple&&t===l.uP.left?-1===this.selectedIndex?this.selectedIndex=this.selectedItems.length-1:this.selectedIndex--:this.multiple&&t===l.uP.right?this.selectedIndex>=this.selectedItems.length-1?this.selectedIndex=-1:this.selectedIndex++:t!==l.uP.backspace&&t!==l.uP.delete||this.deleteCurrentItem())},deleteCurrentItem(){const t=this.selectedIndex,e=this.selectedItems[t];if(!this.isInteractive||this.getDisabled(e))return;const s=this.selectedItems.length-1;if(-1===this.selectedIndex&&0!==s)return void(this.selectedIndex=s);const i=this.selectedItems.length,a=t!==i-1?t:t-1,n=this.selectedItems[a];n?this.selectItem(e):this.setValue(this.multiple?[]:null),this.selectedIndex=a},clearableCallback(){this.internalSearch=null,i.A.options.methods.clearableCallback.call(this)},genInput(){const t=a.A.options.methods.genInput.call(this);return t.data=(0,n.Ay)(t.data,{attrs:{"aria-activedescendant":(0,l.no)(this.$refs.menu,"activeTile.id"),autocomplete:(0,l.no)(t.data,"attrs.autocomplete","off")},domProps:{value:this.internalSearch}}),t},genInputSlot(){const t=i.A.options.methods.genInputSlot.call(this);return t.data.attrs.role="combobox",t},genSelections(){return this.hasSlot||this.multiple?i.A.options.methods.genSelections.call(this):[]},onClick(t){this.isInteractive&&(this.selectedIndex>-1?this.selectedIndex=-1:this.onFocus(),this.isAppendInner(t.target)||this.activateMenu())},onInput(t){if(this.selectedIndex>-1||!t.target)return;const e=t.target,s=e.value;e.value&&this.activateMenu(),this.multiple||""!==s||this.deleteCurrentItem(),this.internalSearch=s,this.badInput=e.validity&&e.validity.badInput},onKeyDown(t){const e=t.keyCode;!t.ctrlKey&&[l.uP.home,l.uP.end].includes(e)||i.A.options.methods.onKeyDown.call(this,t),this.changeSelectedIndex(e)},onSpaceDown(t){},onTabDown(t){i.A.options.methods.onTabDown.call(this,t),this.updateSelf()},onUpDown(t){t.preventDefault(),this.activateMenu()},selectItem(t){i.A.options.methods.selectItem.call(this,t),this.setSearch()},setSelectedItems(){i.A.options.methods.setSelectedItems.call(this),this.isFocused||this.setSearch()},setSearch(){this.$nextTick((()=>{this.multiple&&this.internalSearch&&this.isMenuActive||(this.internalSearch=!this.selectedItems.length||this.multiple||this.hasSlot?null:this.getText(this.selectedItem))}))},updateSelf(){(this.searchIsDirty||this.internalValue)&&(this.multiple||this.valueComparator(this.internalSearch,this.getValue(this.internalValue))||this.setSearch())},hasItem(t){return this.selectedValues.indexOf(this.getValue(t))>-1},onCopy(t){var e,s;if(-1===this.selectedIndex)return;const i=this.selectedItems[this.selectedIndex],a=this.getText(i);null===(e=t.clipboardData)||void 0===e||e.setData("text/plain",a),null===(s=t.clipboardData)||void 0===s||s.setData("text/vnd.vuetify.autocomplete.item+plain",a),t.preventDefault()}}})},4728:function(t,e,s){var i=s(3740);e.A=i.A},1034:function(t,e,s){s(158);var i=s(4152);e.A=(0,i.Gn)("spacer","div","v-spacer")},29:function(){}}]);
//# sourceMappingURL=877.048b2914.js.map
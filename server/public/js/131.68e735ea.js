"use strict";(self["webpackChunkvue2"]=self["webpackChunkvue2"]||[]).push([[131],{3308:function(t,e,a){a.r(e),a.d(e,{default:function(){return R}});var i=a(3740),s=a(3698),r=a(2938),n=a(3180),l=a(4414),o=a(3449),c=a(6814),d=a(9991),m=a(9483),u=a(6930),p=a(8983),h=a(7296),y=a(8924),v=a(2756),f=(a(4114),a(3251)),g=a(7282),b=a(3381),S=a(5803),_=a(4152),x=(0,S.A)(f.A,g.A,b.A).extend({name:"VSkeletonLoader",props:{boilerplate:Boolean,loading:Boolean,loadingText:{type:String,default:"$vuetify.loading"},tile:Boolean,transition:String,type:String,types:{type:Object,default:()=>({})}},computed:{attrs(){return this.isLoading?{"aria-busy":!this.boilerplate||void 0,"aria-live":this.boilerplate?void 0:"polite","aria-label":this.boilerplate?void 0:this.$vuetify.lang.t(this.loadingText),role:this.boilerplate?void 0:"alert",...this.$attrs}:this.$attrs},classes(){return{"v-skeleton-loader--boilerplate":this.boilerplate,"v-skeleton-loader--is-loading":this.isLoading,"v-skeleton-loader--tile":this.tile,...this.themeClasses,...this.elevationClasses}},isLoading(){return!("default"in this.$scopedSlots)||this.loading},rootTypes(){return{actions:"button@2",article:"heading, paragraph",avatar:"avatar",button:"button",card:"image, card-heading","card-avatar":"image, list-item-avatar","card-heading":"heading",chip:"chip","date-picker":"list-item, card-heading, divider, date-picker-options, date-picker-days, actions","date-picker-options":"text, avatar@2","date-picker-days":"avatar@28",heading:"heading",image:"image","list-item":"text","list-item-avatar":"avatar, text","list-item-two-line":"sentences","list-item-avatar-two-line":"avatar, sentences","list-item-three-line":"paragraph","list-item-avatar-three-line":"avatar, paragraph",paragraph:"text@3",sentences:"text@2",table:"table-heading, table-thead, table-tbody, table-tfoot","table-heading":"heading, text","table-thead":"heading@6","table-tbody":"table-row-divider@6","table-row-divider":"table-row, divider","table-row":"table-cell@6","table-cell":"text","table-tfoot":"text@2, avatar@2",text:"text",...this.types}}},methods:{genBone(t,e){return this.$createElement("div",{staticClass:`v-skeleton-loader__${t} v-skeleton-loader__bone`},e)},genBones(t){const[e,a]=t.split("@"),i=()=>this.genStructure(e);return Array.from({length:a}).map(i)},genStructure(t){let e=[];t=t||this.type||"";const a=this.rootTypes[t]||"";if(t===a);else{if(t.indexOf(",")>-1)return this.mapBones(t);if(t.indexOf("@")>-1)return this.genBones(t);a.indexOf(",")>-1?e=this.mapBones(a):a.indexOf("@")>-1?e=this.genBones(a):a&&e.push(this.genStructure(a))}return[this.genBone(t,e)]},genSkeleton(){const t=[];return this.isLoading?t.push(this.genStructure()):t.push((0,_.$c)(this)),this.transition?this.$createElement("transition",{props:{name:this.transition},on:{afterEnter:this.resetStyles,beforeEnter:this.onBeforeEnter,beforeLeave:this.onBeforeLeave,leaveCancelled:this.resetStyles}},t):t},mapBones(t){return t.replace(/\s/g,"").split(",").map(this.genStructure)},onBeforeEnter(t){this.resetStyles(t),this.isLoading&&(t._initialStyle={display:t.style.display,transition:t.style.transition},t.style.setProperty("transition","none","important"))},onBeforeLeave(t){t.style.setProperty("display","none","important")},resetStyles(t){t._initialStyle&&(t.style.display=t._initialStyle.display||"",t.style.transition=t._initialStyle.transition,delete t._initialStyle)}},render(t){return t("div",{staticClass:"v-skeleton-loader",attrs:this.attrs,on:this.$listeners,class:this.classes,style:this.isLoading?this.measurableStyles:void 0},[this.genSkeleton()])}}),C=a(1034),A=a(3307),w=a(812),P=a(4625),D=a(8943),k=a(7112),T=function(){var t=this,e=t._self._c;return e(o.A,{attrs:{fluid:""}},[e(v.A,[e(l.A,{attrs:{cols:"12",md:"4"}},[e(s.A,{staticClass:"mb-4 rounded-lg",attrs:{elevation:"2"}},[e(r.ri,{staticClass:"primary white--text px-4 py-3"},[e(u.A,{attrs:{left:"",color:"white"}},[t._v("mdi-account")]),t._v(" Debtor Information ")],1),e(r.OQ,{staticClass:"pa-4"},[e(p.A,t._l(t.debtorFields,(function(a,i){return e(h.A,{key:i},[e(y.pr,[e(y.w,{staticClass:"text-caption mb-1"},[t._v(t._s(i))]),e(y.UZ,{staticClass:"font-weight-medium"},["Credit Limit"===i||"Available Credit"===i||"Balance"===i?e("span",[t._v("₱")]):t._e(),"Balance"===i?[t._v(" "+t._s(t.formatNumber(t.debtor.creditLimit-t.debtor.availableCredit))+" ")]:[t._v(" "+t._s(t.debtor[a])+" ")]],2)],1)],1)})),1)],1)],1)],1),e(l.A,{attrs:{cols:"12",md:"8"}},[e(s.A,{staticClass:"rounded-lg",attrs:{elevation:"2"}},[e(P.A,{attrs:{"background-color":"primary",dark:""},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e(A.A,[e(u.A,{attrs:{left:""}},[t._v("mdi-history")]),t._v(" Purchase History ")],1),e(A.A,[e(u.A,{attrs:{left:""}},[t._v("mdi-cash-multiple")]),t._v(" Payment History ")],1)],1),e(D.A,{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e(w.A,[e(s.A,{attrs:{flat:""}},[e(r.ri,{staticClass:"px-4 py-3"},[e(C.A),e(k.A,{staticClass:"shrink mt-1",staticStyle:{"max-width":"300px"},attrs:{"prepend-inner-icon":"mdi-magnify",label:"Search",dense:"",outlined:"","hide-details":""},model:{value:t.salesSearch,callback:function(e){t.salesSearch=e},expression:"salesSearch"}})],1),e(c.A,{staticClass:"elevation-0",attrs:{headers:t.salesHeaders,items:t.salesHistory,search:t.salesSearch,loading:t.loadingSales,"items-per-page":10},scopedSlots:t._u([{key:"loading",fn:function(){return[e(x,{staticClass:"pa-4",attrs:{type:"table-row"}})]},proxy:!0},{key:"item.date",fn:function({item:a}){return[e("span",{staticClass:"font-weight-medium"},[t._v(t._s(t.formatDate(a.date)))])]}},{key:"item.salesTotal",fn:function({item:a}){return[e("span",{staticClass:"success--text font-weight-medium"},[t._v("₱"+t._s(t.formatNumber(a.salesTotal)))])]}},{key:"item.amountReceived",fn:function({item:a}){return[e("span",{class:t.getPaymentStatusColor(a)},[t._v("₱"+t._s(t.formatNumber(a.amountReceived)))])]}},{key:"item.paymentType",fn:function({item:a}){return[e(n.A,{attrs:{small:"",color:t.getPaymentTypeColor(a.paymentType),"text-color":"white"}},[t._v(" "+t._s(a.paymentType)+" ")])]}},{key:"item.paymentStatus",fn:function({item:a}){return[e(n.A,{attrs:{small:"",color:t.getPaymentStatusChipColor(a.paymentStatus),"text-color":"white"}},[t._v(" "+t._s(a.paymentStatus)+" ")])]}},{key:"item.actions",fn:function({item:a}){return[e(i.A,{attrs:{small:"",outlined:"",color:"primary"},on:{click:function(e){return t.viewSaleDetails(a)}}},[e(u.A,{attrs:{left:"",small:""}},[t._v("mdi-eye")]),t._v(" Details ")],1)]}}],null,!0)})],1)],1),e(w.A,[e(s.A,{attrs:{flat:""}},[e(r.ri,{staticClass:"px-4 py-3"},[e(C.A),e(k.A,{staticClass:"shrink mt-1",staticStyle:{"max-width":"300px"},attrs:{"prepend-inner-icon":"mdi-magnify",label:"Search payments",dense:"",outlined:"","hide-details":""},model:{value:t.paymentSearch,callback:function(e){t.paymentSearch=e},expression:"paymentSearch"}})],1),e(c.A,{staticClass:"elevation-0",attrs:{headers:t.paymentHeaders,items:t.debtorPayments,search:t.paymentSearch,loading:t.loadingPayments,"items-per-page":10},scopedSlots:t._u([{key:"loading",fn:function(){return[e(x,{staticClass:"pa-4",attrs:{type:"table-row"}})]},proxy:!0},{key:"item.paymentDate",fn:function({item:a}){return[e("span",[t._v(t._s(t.formatDate(a.paymentDate)))])]}},{key:"item.amount",fn:function({item:a}){return[e("span",{staticClass:"success--text"},[t._v("₱"+t._s(t.formatNumber(a.amount)))])]}},{key:"item.paymentMethod",fn:function({item:a}){return[e(n.A,{attrs:{small:"",color:t.getPaymentMethodColor(a.paymentMethod),"text-color":"white"}},[t._v(" "+t._s(a.paymentMethod)+" ")])]}},{key:"item.actions",fn:function({item:a}){return[e(i.A,{attrs:{small:"",outlined:"",color:"primary"},on:{click:function(e){return t.viewPaymentDetails(a)}}},[e(u.A,{attrs:{left:"",small:""}},[t._v("mdi-eye")]),t._v(" Details ")],1)]}}],null,!0)})],1)],1)],1)],1)],1)],1),e(d.A,{attrs:{"max-width":"800px"},model:{value:t.saleDialogVisible,callback:function(e){t.saleDialogVisible=e},expression:"saleDialogVisible"}},[e(s.A,[e(r.ri,{staticClass:"primary white--text"},[e(u.A,{attrs:{left:"",color:"white"}},[t._v("mdi-receipt")]),t._v(" Sale Details "),e(C.A),e("div",{staticClass:"text-subtitle-1"},[t._v(" Ref: "+t._s(t.selectedSale?.referenceCode)+" ")])],1),e(r.OQ,{staticClass:"pa-4"},[e(c.A,{staticClass:"elevation-1 mb-4",attrs:{headers:t.saleDetailHeaders,items:t.selectedSaleItems,"hide-default-footer":""},scopedSlots:t._u([{key:"item.product.name",fn:function({item:e}){return[t._v(" "+t._s(t.getProductName(e))+" ")]}},{key:"item.product.price",fn:function({item:e}){return[t._v(" ₱"+t._s(t.formatNumber(e.product.price))+" ")]}},{key:"item.subtotal",fn:function({item:a}){return[e("span",{staticClass:"font-weight-bold"},[t._v(" ₱"+t._s(t.formatNumber(a.product.price*a.quantity))+" ")])]}}],null,!0)}),e(m.A),e(v.A,{staticClass:"mt-4",attrs:{justify:"end"}},[e(l.A,{attrs:{cols:"12",sm:"4"}},[e("div",{staticClass:"d-flex justify-space-between"},[e("span",{staticClass:"text-subtitle-1"},[t._v("Total:")]),e("span",{staticClass:"text-h6 primary--text"},[t._v("₱"+t._s(t.formatNumber(t.calculateTotal)))])])])],1)],1),e(r.SL,{staticClass:"pa-4"},[e(C.A),e(i.A,{attrs:{color:"grey darken-1",text:""},on:{click:function(e){t.saleDialogVisible=!1}}},[t._v("Close")])],1)],1)],1),e(d.A,{attrs:{"max-width":"600px"},model:{value:t.paymentDialogVisible,callback:function(e){t.paymentDialogVisible=e},expression:"paymentDialogVisible"}},[e(s.A,[e(r.ri,{staticClass:"primary white--text"},[e(u.A,{attrs:{left:"",color:"white"}},[t._v("mdi-cash")]),t._v(" Payment Details "),e(C.A),e("div",{staticClass:"text-subtitle-1"},[t._v(" Ref: "+t._s(t.selectedPayment?.referenceNumber)+" ")])],1),e(r.OQ,{staticClass:"pa-4"},[e(p.A,[e(h.A,[e(y.pr,[e(y.w,{staticClass:"text-caption"},[t._v("Date")]),e(y.UZ,[t._v(t._s(t.formatDate(t.selectedPayment?.paymentDate)))])],1)],1),e(h.A,[e(y.pr,[e(y.w,{staticClass:"text-caption"},[t._v("Amount")]),e(y.UZ,{staticClass:"success--text"},[t._v(" ₱"+t._s(t.formatNumber(t.selectedPayment?.amount))+" ")])],1)],1),e(h.A,[e(y.pr,[e(y.w,{staticClass:"text-caption"},[t._v("Payment Method")]),e(y.UZ,[e(n.A,{attrs:{small:"",color:t.getPaymentMethodColor(t.selectedPayment?.paymentMethod),"text-color":"white"}},[t._v(" "+t._s(t.selectedPayment?.paymentMethod)+" ")])],1)],1)],1),t.selectedPayment?.notes?e(h.A,[e(y.pr,[e(y.w,{staticClass:"text-caption"},[t._v("Notes")]),e(y.UZ,[t._v(t._s(t.selectedPayment?.notes))])],1)],1):t._e()],1)],1),e(r.SL,{staticClass:"pa-4"},[e(C.A),e(i.A,{attrs:{color:"grey darken-1",text:""},on:{click:function(e){t.paymentDialogVisible=!1}}},[t._v("Close")])],1)],1)],1)],1)},L=[],$=a(5353),B={name:"DebtorProfile",data:()=>({activeTab:0,debtor:{},salesHistory:[],debtorPayments:[],selectedSale:null,selectedSaleItems:[],selectedPayment:null,salesSearch:"",paymentSearch:"",loadingSales:!1,loadingPayments:!1,saleDialogVisible:!1,paymentDialogVisible:!1,debtorFields:{Name:"name","Credit Limit":"creditLimit","Available Credit":"availableCredit",Balance:t=>t?.creditLimit-t?.availableCredit||0,Address:"address",Contact:"contact"},salesHeaders:[{text:"Date",value:"date",width:"15%"},{text:"Reference",value:"referenceCode",width:"15%"},{text:"Total",value:"salesTotal",width:"15%"},{text:"Received",value:"amountReceived",width:"15%"},{text:"Payment Type",value:"paymentType",width:"15%"},{text:"Options",value:"actions",sortable:!1,width:"10%"}],saleDetailHeaders:[{text:"Product",value:"product.name",width:"40%"},{text:"Quantity",value:"quantity",width:"20%"},{text:"Price",value:"product.price",width:"20%"},{text:"Subtotal",value:"subtotal",width:"20%"}],paymentHeaders:[{text:"Date",value:"paymentDate",width:"20%"},{text:"Reference",value:"referenceNumber",width:"20%"},{text:"Amount",value:"amount",width:"20%"},{text:"Method",value:"paymentMethod",width:"20%"},{text:"Notes",value:"notes",width:"10%"},{text:"Options",value:"actions",sortable:!1,width:"10%"}]}),computed:{calculateTotal(){return this.selectedSaleItems?.length?this.selectedSaleItems.reduce(((t,e)=>{const a=e.product?.price||0,i=e.quantity||0;return t+a*i}),0):0},balanceComputed(){return this.debtor.creditLimit&&this.debtor.availableCredit?this.debtor.creditLimit-this.debtor.availableCredit:0}},async created(){await this.loadData()},methods:{...(0,$.i0)({getDebtor:"debtor/getDebtor",getDebtorSales:"sale/getDebtorSales",getDebtorPayments:"debtorPayment/getDebtorPayments"}),async loadData(){const t=this.$route.params.id;this.loadingSales=!0,this.loadingPayments=!0;try{const[e,a,i]=await Promise.all([this.getDebtor(t),this.getDebtorSales(t),this.getDebtorPayments(t)]);this.debtor=e,this.salesHistory=a,this.debtorPayments=i}catch(e){console.error("Error loading data:",e),this.$toast.error("Failed to load data")}finally{this.loadingSales=!1,this.loadingPayments=!1}},formatDate(t){return new Date(t).toLocaleDateString("en-PH",{year:"numeric",month:"short",day:"numeric"})},formatNumber(t){return null==t?"0.00":t.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})},getPaymentStatusColor(t){const e=t.amountReceived/t.salesTotal;return e>=1?"success--text font-weight-medium":e>=.5?"warning--text font-weight-medium":"error--text font-weight-medium"},getPaymentTypeColor(t){const e={CASH:"success",CREDIT:"warning",PARTIAL:"orange",INSTALLMENT:"blue"};return e[t.toUpperCase()]||"grey"},getPaymentMethodColor(t){const e={CASH:"success",CHECK:"info",GCASH:"primary",OTHERS:"grey"};return e[t?.toUpperCase()]||"grey"},getPaymentStatusChipColor(t){const e={paid:"success",unpaid:"error"};return e[t]||"grey"},getProductName(t){if("Variants"===t.product.type&&t.variant){const e=t.product.variants.find((e=>e._id.toString()===t.variant.toString()));return e?.name||t.product.name}return t.product.name},viewSaleDetails(t){this.selectedSale=t,this.selectedSaleItems=t.items.map((t=>({...t,product:{...t.product,price:this.getVariantPrice(t)}}))),this.saleDialogVisible=!0},viewPaymentDetails(t){this.selectedPayment=t,this.paymentDialogVisible=!0},getVariantPrice(t){if("Variants"===t.product.type&&t.variant){const e=t.product.variants.find((e=>e._id.toString()===t.variant.toString()));return e?.price||t.product.price}return t.product.price},async printReceipt(){try{await this.$print({ref:this.selectedSale.referenceCode,items:this.selectedSaleItems,total:this.calculateTotal}),this.$toast.success("Receipt printed successfully")}catch(t){console.error("Print error:",t),this.$toast.error("Failed to print receipt")}},async printPaymentReceipt(){try{await this.$print({ref:this.selectedPayment.referenceNumber,amount:this.selectedPayment.amount,method:this.selectedPayment.paymentMethod,date:this.formatDate(this.selectedPayment.date),notes:this.selectedPayment.notes}),this.$toast.success("Payment receipt printed successfully")}catch(t){console.error("Print error:",t),this.$toast.error("Failed to print payment receipt")}}},watch:{"$route.params.id":{handler:"loadData",immediate:!0}}},N=B,H=a(1656),V=(0,H.A)(N,T,L,!1,null,"39c67069",null),R=V.exports},3449:function(t,e,a){a.d(e,{A:function(){return n}});a(158),a(125);var i=a(5471);function s(t){return i["default"].extend({name:`v-${t}`,functional:!0,props:{id:String,tag:{type:String,default:"div"}},render(e,{props:a,data:i,children:s}){i.staticClass=`${t} ${i.staticClass||""}`.trim();const{attrs:r}=i;if(r){i.attrs={};const t=Object.keys(r).filter((t=>{if("slot"===t)return!1;const e=r[t];return t.startsWith("data-")?(i.attrs[t]=e,!1):e||"string"===typeof e}));t.length&&(i.staticClass+=` ${t.join(" ")}`)}return a.id&&(i.domProps=i.domProps||{},i.domProps.id=a.id),e(a.tag,i,s)}})}var r=a(8041),n=s("container").extend({name:"v-container",functional:!0,props:{id:String,tag:{type:String,default:"div"},fluid:{type:Boolean,default:!1}},render(t,{props:e,data:a,children:i}){let s;const{attrs:n}=a;return n&&(a.attrs={},s=Object.keys(n).filter((t=>{if("slot"===t)return!1;const e=n[t];return t.startsWith("data-")?(a.attrs[t]=e,!1):e||"string"===typeof e}))),e.id&&(a.domProps=a.domProps||{},a.domProps.id=e.id),t(e.tag,(0,r.Ay)(a,{staticClass:"container",class:Array({"container--fluid":e.fluid}).concat(s||[])}),i)}})}}]);
//# sourceMappingURL=131.68e735ea.js.map